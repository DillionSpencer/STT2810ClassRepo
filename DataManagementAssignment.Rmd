---
title: "Data Management Assignment"
author: "Spring 2015"
date: "February 2, 2015"
output: html_document
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(comment = NA, message = FALSE, warning = FALSE, fig.align='center')
library(dplyr)
library(ggplot2)
library(descr)
```

We will consider several variables from the `AddHealth` data set.  Looking in the code book
for `H1SU1` suggest responses of 6, 8, and 9 should be recoded to `NA`.

```{r}
library(PDS)
xtabs(~H1SU1, data = AddHealth)
AddHealth$H1SU1[AddHealth$H1SU1==6 | AddHealth$H1SU1==8 | AddHealth$H1SU1==9] <- NA
xtabs(~H1SU1, data = AddHealth)
AddHealth$H1SU1 <- factor(AddHealth$H1SU1, labels = c("No", "Yes"))[, drop = TRUE]
xtabs(~H1SU1, data = AddHealth)
summary(AddHealth$H1SU1)
freq(AddHealth$H1SU1)
freq(AddHealth$H1SU1, main = "Did you ever seriously think about committing suicide?", col = c("skyblue", "gray"))
ggplot(data = AddHealth, aes(x = H1SU1, fill = H1SU1)) + 
  geom_bar() + 
  labs(title = "Did you ever seriously think about committing suicide?", x = "") +
  theme_bw() 
```


Question `H1SU2` asks the 821 repondents from `H1SU1` "how many times did you attempt suicide?"  Responses of
6, 7, and 8 should be recoded to `NA`.

```{r}
xtabs(~H1SU2, data = AddHealth)
AddHealth$H1SU2[AddHealth$H1SU2==6 | AddHealth$H1SU2==7 | AddHealth$H1SU2==8] <- NA
xtabs(~H1SU2, data = AddHealth)
AddHealth$H1SU2 <- factor(AddHealth$H1SU2)[, drop = TRUE]
xtabs(~H1SU2, data = AddHealth)
AddHealth$H1SU2 <- factor(AddHealth$H1SU2, labels = c("0 times", "1 time", "2 or 3 times", "4 or 5 times", ">= 6 times"))
summary(AddHealth$H1SU2)
xtabs(~H1SU2, data = AddHealth)
NAS <- sum(xtabs(~H1SU2, data = AddHealth)[-1])  # number that actually attempted suicide
NAS
freq(AddHealth$H1SU2)
ggplot(data = AddHealth, aes(x = H1SU2)) + 
  geom_bar(fill = "maroon") + 
  labs(title = "How many times did you actually attempt suicide?", x= "") +
  theme_bw() 
ggplot(data = na.omit(AddHealth[ , "H1SU2", drop = FALSE]), aes(x = H1SU2)) + 
  geom_bar(fill = "plum") + 
  labs(title = "How many times did you actually attempt suicide?", x = "") +
  theme_bw() 
ggplot(data = na.omit(AddHealth[ , "H1SU2", drop = FALSE]), aes(x = H1SU2, fill = H1SU2)) + 
  geom_bar() + 
  labs(title = "How many times did you actually attempt suicide?", x = "") +
  theme_bw() 
```

Question `H1SU3` asks of the `r NAS` that attempted suicide if they had to be treated by either a nurse or doctor.  The response of 7 should be recoded to `NA`.

```{r}
AddHealth$H1SU3[AddHealth$H1SU3 == 7] <- NA
AddHealth$H1SU3 <- factor(AddHealth$H1SU3, labels = c("No", "Yes"))[, drop = TRUE]
xtabs(~H1SU3, data = AddHealth)
freq(AddHealth$H1SU3)
ggplot(data = na.omit(AddHealth[ , "H1SU3", drop = FALSE]), aes(x = H1SU3, fill = H1SU3)) + 
  geom_bar() + 
  labs(title = "Did you require treatment by either a nurse of doctor?", x = "") +
  theme_bw() 
```